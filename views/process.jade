extends layout
block content
    // arguments
    .wrapper
        if (job)
            .panel.panel-default(id="argumentsPanel")
                .panel-heading
                    h3.panel-title arguments
                .panel-body
                    pre.prettyprint.linenums.lang-js(id="arguments")

    .wrapper
        .panel.panel-default(id="consolePanel")
            .panel-heading
                h3.panel-title Console message
            .panel-body
                pre(id='consoleLog')

    // allJobs list
    .wrapper
        .panel.panel-default(id="allJobsList")
            .panel-heading
                h4 Your Jobs
            ul.list-group
                if (allJobs.length === 0)
                    li(class="list-group-item")
                        | No Jobs.
                each item, index in allJobs
                    li(class="list-group-item")
                        .num
                            span= index + 1
                            | .&nbsp;&nbsp;
                        .name
                            span= item.name
                        .status
                            span= item.status

    // for arguments
    // http://stackoverflow.com/questions/8399547/how-to-add-line-numbers-to-all-lines-in-google-prettify
    style.
        .prettyprint ol.linenums > li {
            list-style-type: decimal;
        }
    script(type='text/javascript').
        var data = !{job};
        var jsonPretty = JSON.stringify(data, null, '    ');
        $("pre#arguments").text(jsonPretty);
    script(type='text/javascript').
        (function (jQuery) {
            jQuery(document).ready(function () {
                prettyPrint();
            });
        }(jQuery))

    // for console
    script(type='text/javascript').
        var socket = io.connect();
        socket.on('news', function (data) {
            $('#consoleLog').append(data.data);
            //scroll the div to follow last line added!
            var objDiv = document.getElementById("consoleLog");
            objDiv.scrollTop = objDiv.scrollHeight;
        });
